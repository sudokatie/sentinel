{{define "check.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Check.Name}} - Sentinel</title>
    <link rel="stylesheet" href="{{.BasePath}}/static/css/style.css">
</head>
<body>
    <header>
        <a href="{{.BasePath}}/" class="logo">SENTINEL</a>
        <button class="menu-toggle" onclick="document.querySelector('.nav-links').classList.toggle('open')">â˜°</button>
        <div class="nav-links">
            <a href="{{.BasePath}}/">Dashboard</a>
            <a href="{{.BasePath}}/settings">Settings</a>
            <a href="{{.BasePath}}/logout">Logout</a>
        </div>
    </header>
    <main>
        <a href="{{.BasePath}}/" class="back-link">&larr; Back to Dashboard</a>

        <div class="check-header">
            <h1>{{.Check.Name}}</h1>
            <span class="check-status-large {{.Check.Status}}">{{.Check.Status}}</span>
            <div class="check-meta">
                <div class="meta-item">
                    <label>URL</label>
                    <span>{{.Check.URL}}</span>
                </div>
                <div class="meta-item">
                    <label>Interval</label>
                    <span>{{.Check.IntervalSecs}}s</span>
                </div>
                <div class="meta-item">
                    <label>Timeout</label>
                    <span>{{.Check.TimeoutSecs}}s</span>
                </div>
                <div class="meta-item">
                    <label>Expected</label>
                    <span>{{.Check.ExpectedStatus}}</span>
                </div>
            </div>
        </div>

        {{if .Stats}}
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Uptime 24h</div>
                <div class="stat-value">{{printf "%.1f" .Stats.UptimePercent24h}}<small>%</small></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Uptime 7d</div>
                <div class="stat-value">{{printf "%.1f" .Stats.UptimePercent7d}}<small>%</small></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Uptime 30d</div>
                <div class="stat-value">{{printf "%.1f" .Stats.UptimePercent30d}}<small>%</small></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Avg Response 24h</div>
                <div class="stat-value">{{.Stats.AvgResponseMs24h}}<small>ms</small></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Avg Response 7d</div>
                <div class="stat-value">{{.Stats.AvgResponseMs7d}}<small>ms</small></div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Avg Response 30d</div>
                <div class="stat-value">{{.Stats.AvgResponseMs30d}}<small>ms</small></div>
            </div>
        </div>
        {{end}}

        {{if .Results}}
        <div class="chart-section">
            <div class="chart-header">
                <h2>Response Time</h2>
                <div class="period-selector">
                    <a href="?period=24h" class="period-btn {{if eq .Period "24h"}}active{{end}}">24h</a>
                    <a href="?period=7d" class="period-btn {{if eq .Period "7d"}}active{{end}}">7d</a>
                    <a href="?period=30d" class="period-btn {{if eq .Period "30d"}}active{{end}}">30d</a>
                </div>
            </div>
            <canvas id="responseChart"></canvas>
        </div>
        <script>
            var chartData = {
                values: [{{range $i, $r := .Results}}{{if $i}},{{end}}{{$r.ResponseTimeMs}}{{end}}],
                labels: [{{range $i, $r := .Results}}{{if $i}},{{end}}"{{$r.CheckedAt.Format "15:04"}}"{{end}}],
                statuses: [{{range $i, $r := .Results}}{{if $i}},{{end}}"{{$r.Status}}"{{end}}]
            };
        </script>
        {{end}}

        {{if .Incidents}}
        <div class="incidents-section">
            <h2>Incident History</h2>
            <div class="incidents-list">
                {{range .Incidents}}
                <div class="incident {{if .IsActive}}active{{else}}resolved{{end}}">
                    <span class="incident-status">{{if .IsActive}}Ongoing{{else}}Resolved{{end}}</span>
                    <div class="incident-info">
                        <span class="incident-time">{{.StartedAt.Format "Jan 2, 15:04"}}</span>
                        {{if not .IsActive}}
                        <span class="incident-duration">Duration: {{.DurationString}}</span>
                        {{end}}
                        {{if .Cause}}
                        <span class="incident-cause">{{.Cause}}</span>
                        {{end}}
                    </div>
                </div>
                {{end}}
            </div>
        </div>
        {{end}}
    </main>
    <footer>
        Sentinel Uptime Monitor
    </footer>
    <script src="{{.BasePath}}/static/js/app.js"></script>
</body>
</html>
{{end}}
